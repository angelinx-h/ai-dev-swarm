# Stage 06 - Architecture

Design the complete system architecture including components, data flow, infrastructure, and technical decisions that will guide all subsequent development work.

## Instructions

### 1. Context Review

Read all the files below to understand the design of this project so far:

- `ideas.md`
- `00-init-ideas/` - All markdown files
- `01-market-research/` - All markdown files
- `02-personas/` - All markdown files
- `03-mvp/` - All markdown files
- `04-prd/` - All markdown files
- `05-ux/` - All markdown files

### 2. Create Stage Proposal

Create the file `06-architecture/README.md` with the following content:

#### 2.1 Stage Goal

Brief the goal of this stage in 2-3 paragraphs:
- What this stage aims to achieve (define system architecture, tech stack, data models, APIs)
- Why architecture design is critical before development begins
- How this stage builds upon previous stages (UX flows, PRD requirements, MVP scope)
- What deliverables will be produced

#### 2.2 File Selection

Pick and list the file names from the options below that are most suitable for this project:

**System Architecture:**
- `system-architecture.md` - Overall system architecture describing components, layers, and their interactions
- `architecture-diagram.mmd` - Mermaid diagram showing high-level system architecture
- `C4-component-diagram.mmd` - C4 model diagrams: Context (Level 1), Containers (Level 2), Components (Level 3)

**Technology Stack:**
- `tech-stack.md` - Selected languages, frameworks, libraries, and tools
- `tech-stack-rationale.md` - Detailed reasoning for each technology choice

**Database Design:**
- `database-design.md` - Database schema design, relationships, and data modeling approach
- `database-schema.mmd` - Mermaid ER diagram showing tables, columns, and relationships

**API Architecture:**
- `api-design.md` - API architecture patterns, authentication, versioning strategy
- `api-endpoints.md` - Complete listing of API endpoints with methods, parameters, and responses

**Infrastructure:**
- `infrastructure-design.md` - Overview of infrastructure components (servers, cloud services, CDN)
- `infrastructure-diagram.mmd` - Mermaid diagram showing infrastructure topology

**Security & Scalability:**
- `security-architecture.md` - Security design including authentication, authorization, encryption, and threat mitigation
- `scalability-plan.md` - Scalability considerations, horizontal/vertical scaling strategies

**Data & Integrations:**
- `data-flow-diagram.mmd` - Mermaid diagram showing how data moves between User, Server, AWS S3, RunPod, and other services
- `integration-architecture.md` - Third-party service integrations and their architectural impact

For each selected file, provide:
- Short description of what the file contains
- Why it's essential for this specific project
- What key information it should include

**Note:** Select files based on project complexity and requirements. Not all files may be necessary for every project. Simple projects may need fewer files.

#### 2.3 Request User Approval

Present the stage plan to the user and ask - Please check the Stage Proposal file in `06-architecture/README.md`, and update it directly or tell me how to update it

### 3. Execute Stage Plan

Once the user updates & approves the plan in `06-architecture/README.md`, read the file and understand user's update for the next step:

#### 3.1 Create All Planned Files

Create each file listed in the approved README.md within the `06-architecture/` folder:

- **For `.md` files:** Write comprehensive, well-structured content with clear sections and technical details
- **For `.mmd` files:** Create clear Mermaid diagrams using appropriate syntax (flowchart, erDiagram, C4, etc.)

**Quality Guidelines:**
- Base architecture decisions on PRD requirements and UX designs from previous stages
- Ensure tech stack choices align with team capabilities and project constraints
- Design for the MVP scope first, with considerations for future scalability
- Include clear component boundaries and interfaces
- Document all major architectural decisions and their trade-offs
- Ensure database design supports all identified use cases
- API design should follow RESTful or GraphQL best practices as appropriate
- Security architecture must address authentication, authorization, data protection
- Infrastructure design should consider cost, performance, and reliability

#### 3.2 Request User Approval for Files

After creating all files, present them to the user:
- Provide a summary of what was created
- Highlight key architectural decisions and trade-offs
- Ask: "Please review the architecture design. You can update or delete the files or let me know how to do it"

### 4. Finalize Stage

Once the user approves all files, you need to check all the files content, and if any files have been deleted understand the user's intent:

#### 4.1 Documentation Finalization
- Sync with `06-architecture/README.md` to remove any deleted files which the user doesn't want to have
- Ensure all files are complete and well-formatted
- Verify that architecture supports all PRD requirements
- Confirm all Mermaid diagrams render correctly
- Check that tech stack, database, API, and infrastructure designs are consistent

#### 4.2 Prepare for Next Stage
- Summarize key architectural decisions for reference in tech-specs stage
- Identify any technical risks or open questions that need validation
- Note dependencies that need to be resolved before development

#### 4.3 Announce Completion
Inform the user:
- "Stage 06 (Architecture) is complete"
- Summary of deliverables created
- Key architectural decisions made
- "Ready to proceed to Stage 07 (Tech Specs) when you are"

## Role Communication

Based on the stage context and project details, pick up your roles from `dev-swarm/docs/dev-swarm-roles.md` to announce your actions before performing them using the following format:

**As a {Role} [and {Role}, ...], I will {action description}**

## Communication Pattern

This communication pattern ensures:
- **Transparency** - Users know exactly what you're doing and why
- **Human-in-the-loop oversight** - Users can intervene at key decision points
- **Role clarity** - Clear understanding of which expertise is being applied
- **Traceability** - Easy to track which role made which decisions

Always announce your role and action before:
- Reading and analyzing documents
- Creating new files or documents
- Making recommendations or decisions
- Requesting user approval
- Finalizing deliverables
